(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{195:function(e){e.exports={vhosts:[{name:"logs"}],policies:[{vhost:"logs",name:"logs",pattern:".*","apply-to":"all",definition:{"ha-mode":"all","ha-sync-mode":"manual"},priority:0}],queues:[{name:"log",vhost:"logs",durable:!0,auto_delete:!1,arguments:{}},{name:"critical",vhost:"logs",durable:!0,auto_delete:!1,arguments:{}},{name:"alert",vhost:"logs",durable:!0,auto_delete:!1,arguments:{}}],exchanges:[{name:"logs",vhost:"logs",type:"topic",durable:!0,auto_delete:!1,internal:!1,arguments:{}}],bindings:[{source:"logs",vhost:"logs",destination:"log",destination_type:"queue",routing_key:"log.*",arguments:{}},{source:"logs",vhost:"logs",destination:"critical",destination_type:"queue",routing_key:"*.critical",arguments:{}},{source:"logs",vhost:"logs",destination:"alert",destination_type:"queue",routing_key:"alert.*",arguments:{}}]}},209:function(e,t,n){e.exports=n.p+"static/media/logo.3938d65c.svg"},221:function(e,t,n){e.exports=n(423)},422:function(e,t,n){},423:function(e,t,n){"use strict";n.r(t);var o=n(1),i=n(64),r=(n(226),n(227),n(429)),a=n(434),c=n(433),s=n(36),u=n(37),l=n(40),d=n(38),f=n(41),h=n(194),g=n(19),m=n(43),v=n(211),p=n(135),b=n(127),y={height:30,width:180};function E(e){var t=b.cloneDeep(e);return function(e){var t=function(e){return e.nodes.map(function(e){return{id:e.id,metadata:Object(v.a)({},y,{id:e.id})}})}(e),n=function(e){return e.links.map(function(e){return{from:e.source,to:e.target}}).filter(function(t){return e.nodes.find(function(e){return e.id===t.from})&&e.nodes.find(function(e){return e.id===t.to})})}(e),o=new p.graphlib.Graph;return o.setGraph({rankdir:"LR",ranksep:100}),o.setDefaultEdgeLabel(function(){return{}}),t.forEach(function(e){o.setNode(e.id,e.metadata)}),n.forEach(function(e){e.from&&e.to&&o.setEdge(e.from,e.to)}),p.layout(o),o.nodes().map(function(e){return o.node(e)})}(t).forEach(function(e){var n=t.nodes.find(function(t){return t.id===e.id});n.x=e.x,n.y=e.y}),t}var w="rgb(0,192,255)",O="rgb(192,255,0)",k={definition:{bindings:[],exchanges:[],parameters:[],policies:[],queues:[],vhosts:[]},isValid:!0,validate:function(e,t,n){return null}};function j(){return Object(g.a)(k,function(e){e.isValid=!0})}function S(e,t,n){var o=[],i=[],r=[],a=new m.DiagramModel,c=e.bindings.filter(function(e){return"All"===t.currentVhost||e.vhost===t.currentVhost});(c.length>0?function(e){var t=[];return e.forEach(function(e){var n=t.findIndex(function(t){return t.vhost===e.vhost&&t.source===e.source&&t.destination===e.destination&&t.destinationType===e.destination_type});-1===n?t.push({destination:e.destination,destinationType:e.destination_type,routingKeys:""===e.routing_key?[]:[e.routing_key],source:e.source,vhost:e.vhost}):""!==e.routing_key&&t[n].routingKeys.push(e.routing_key)}),t}(c):[]).forEach(function(e){var n,a,c=e.vhost,s="Exchange: ".concat(e.source," ").concat("All"===t.currentVhost?"(".concat(c,")"):""),u=o.find(function(e){return e.name===s});void 0===u&&(u=D(s,w),o.push(u)),"queue"===e.destinationType?(a="Queue: ".concat(e.destination," ").concat("All"===t.currentVhost?"(".concat(c,")"):""),void 0===(n=i.find(function(e){return e.name===a}))&&(n=D(a,O),i.push(n))):(a="Exchange: ".concat(e.destination," ").concat("All"===t.currentVhost?"(".concat(c,")"):""),void 0===(n=o.find(function(e){return e.name===a}))&&(n=D(a,w),o.push(n)));var l=u.getOutPorts().length>0?u.getOutPorts()[0]:u.addOutPort("Out"),d=n.getInPorts().length>0?n.getInPorts()[0]:n.addInPort("In"),f=l.createLinkModel();f.setSourcePort(l),f.setTargetPort(d),t.showRoutingKeys&&e.routingKeys.forEach(function(e){return f.addLabel(e)}),r.push(f)});var s=1,u=1;return o.forEach(function(e){e.getInPorts().length>0&&e.getOutPorts().length>0?(e.x=300,e.y=70*u,u++):(e.x=70,e.y=70*s,s++),a.addNode(e)}),i.forEach(function(e,t){e.x=530,e.y=70*(t+1),a.addNode(e)}),r.forEach(function(e){a.addLink(e)}),function(e,t){var n=E(t.serializeDiagram()),o=new m.DiagramModel;return o.deSerializeDiagram(n,e),o}(n,a)}function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rgb(0,192,255)";return new m.DefaultNodeModel(e,t)}var x={currentVhost:"",errors:[],selectVhost:function(e,t){return null},setZoomFunction:function(){return null},showRoutingKeys:!0,toggleShowRoutingKeys:function(){return null},zoomToFit:function(){return null}};function C(){return Object(g.a)(x,function(e){e.currentVhost="All"})}var V=o.createContext(j()),_=o.createContext(C()),z=n(195);n(382);var R=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={code:""},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){e.setState({code:JSON.stringify(z,null,2)})},50)}},{key:"render",value:function(){var e=this;return o.createElement(V.Consumer,null,function(t){return o.createElement(h.UnControlled,{value:e.state.code,options:{lineNumbers:!0,mode:"application/json",theme:"material"},onChange:t.validate})})}}]),t}(o.Component),F=n(431),I=(n(383),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).engine=void 0,n.zoomFunctionSet=void 0,n.engine=new m.DiagramEngine,n.engine.installDefaultFactories(),n.zoomFunctionSet=!1,n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return o.createElement(_.Consumer,null,function(t){return o.createElement(V.Consumer,null,function(n){return n.definition.vhosts.length>0?e.renderDefinitionDiagram(n,t):e.renderMessageBox(t)})})}},{key:"renderMessageBox",value:function(e){return(new m.DiagramEngine).installDefaultFactories(),e.errors.length>0?o.createElement(F.a,{error:!0,header:"Invalid broker definition json",list:e.errors,attached:"top",icon:"exclamation circle"}):o.createElement(F.a,{content:"Please load a broker definition using the editor panel.",header:"No Broker Definition Present",info:!0,attached:"top",icon:"info circle"})}},{key:"renderDefinitionDiagram",value:function(e,t){var n=this,i=S(e.definition,t,this.engine);return this.engine.setDiagramModel(i),this.zoomFunctionSet||(t.setZoomFunction(function(){n.engine.zoomToFit()}),this.zoomFunctionSet=!0),o.createElement(m.DiagramWidget,{className:"srd-canvas",diagramEngine:this.engine,inverseZoom:!0})}}]),t}(o.Component)),P=n(435),T=n(432),K=n(430);var N=function(){return o.createElement(_.Consumer,null,function(e){return o.createElement(V.Consumer,null,function(t){return t.definition.vhosts.length>0?o.createElement(c.a,{attached:"top"},function(e,t,n){var i=function(e){var t=[{key:"All",value:"All",text:"All"}];return e.forEach(function(e){return t.push({key:e.name,value:e.name,text:e.name})}),t}(e);return o.createElement(c.a.Item,null,"Virtual Host:\xa0",o.createElement(K.a,{placeholder:"Virtual Hosts",value:t,selection:!0,options:i,onChange:n}))}(t.definition.vhosts,e.currentVhost,e.selectVhost),o.createElement(c.a.Item,null,o.createElement(P.a,{toggle:!0,label:"Show Routing Keys",onChange:e.toggleShowRoutingKeys,checked:e.showRoutingKeys})),o.createElement(c.a.Item,null,o.createElement(T.a,{onClick:e.zoomToFit,content:"Zoom to Fit"}))):""})})},A=n(210),q=n(65),M=n(209),B=n.n(M),L=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.createElement(c.a,{fixed:"top",inverted:!0},o.createElement(r.a,{fluid:!0},o.createElement(c.a.Item,{header:!0,as:"h4"},o.createElement(A.a,{size:"mini",src:B.a,style:{marginRight:"1.5em"}}),"Rabbit Viz"),o.createElement(c.a.Item,{position:"right",href:"https://github.com/plexsystems/rabbit-viz",target:"_blank"},o.createElement(q.a,{name:"github",size:"big"}),"Fork us on GitHub!")))}}]),t}(o.Component),J=n(72),W=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={clusterDefinition:Object(g.a)(j(),function(e){e.validate=n.validateDefinitionsJson.bind(Object(J.a)(Object(J.a)(n)))}),viewState:Object(g.a)(C(),function(e){e.selectVhost=function(e,t){n.setState(Object(g.a)(function(e){e.viewState.currentVhost=t.value}))},e.setZoomFunction=function(e){n.setState(Object(g.a)(function(t){t.viewState.zoomToFit=e}))},e.toggleShowRoutingKeys=function(){n.setState(Object(g.a)(function(e){e.viewState.showRoutingKeys=!e.viewState.showRoutingKeys}))}})},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.createElement(_.Provider,{value:this.state.viewState},o.createElement(V.Provider,{value:this.state.clusterDefinition},this.props.children))}},{key:"validateDefinitionsJson",value:function(e,t,n){if(n.length>0)try{var o=JSON.parse(n);o.vhosts=o.vhosts.sort(function(e,t){return e.name>t.name?1:e.name<t.name?-1:0}),this.setState(Object(g.a)(function(e){e.clusterDefinition.isValid=!0,e.viewState.errors=[],e.clusterDefinition.definition=o}))}catch(i){return void this.setState(Object(g.a)(function(e){e.clusterDefinition.isValid=!1,e.viewState.errors=[i.message],e.clusterDefinition.definition={bindings:[],exchanges:[],parameters:[],policies:[],queues:[],vhosts:[]}}))}else this.setState(Object(g.a)(function(e){e.clusterDefinition.isValid=!0,e.viewState.errors=[],e.clusterDefinition.definition={bindings:[],exchanges:[],parameters:[],policies:[],queues:[],vhosts:[]}}))}}]),t}(o.Component),Z=function(){return o.createElement(W,null,o.createElement(L,null),o.createElement(r.a,{fluid:!0},o.createElement(a.a,{style:{height:"100vh"},centered:!0,celled:"internally"},o.createElement(a.a.Row,{style:{height:"100%"}},o.createElement(a.a.Column,{width:12,style:{padding:0,marginTop:"4.5em",marginBottom:"2.5em"},className:"srd-container"},o.createElement(N,null),o.createElement(I,null)),o.createElement(a.a.Column,{width:4,style:{padding:0,marginTop:"4.5em",marginBottom:"2.5em"}},o.createElement(R,null))))),o.createElement(c.a,{fixed:"bottom",inverted:!0},o.createElement(c.a.Item,{header:!0,position:"right"},"\xa9 2019 Plex Systems, Inc. All Rights Reserved.")))},G=(n(422),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function H(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.render(o.createElement(Z,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/rabbit-viz",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/rabbit-viz","/service-worker.js");G?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):H(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):H(e)})}}()}},[[221,1,2]]]);
//# sourceMappingURL=main.18299808.chunk.js.map